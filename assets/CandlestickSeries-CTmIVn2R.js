import{r as M}from"./index-CTzypqlY.js";import{g as R}from"./group-CTbjIu5X.js";import{p as x}from"./barWidth-H00B5QnB.js";import{f as w,G as D,b as v}from"./withSize-Bqu-aQP_.js";class g extends M.Component{constructor(){super(...arguments),this.drawOnCanvas=(e,c)=>{const{candleStrokeWidth:i=g.defaultProps.candleStrokeWidth}=this.props,{xScale:l,chartConfig:{yScale:u},plotData:d,xAccessor:h}=c,f=this.getCandleData(h,l,u,d);R(f,r=>r.wick.stroke).forEach((r,a)=>{e.fillStyle=a,r.forEach(p=>{const o=p.wick;e.fillRect(o.x-.5,o.y1,1,o.y2-o.y1),e.fillRect(o.x-.5,o.y3,1,o.y4-o.y3)})}),R(f,r=>r.stroke,r=>r.fill).forEach((r,a)=>{a!=="none"&&(e.strokeStyle=a,e.lineWidth=i),r.forEach((p,o)=>{e.fillStyle=o,p.forEach(t=>{t.width<=1?e.fillRect(t.x-.5,t.y,1,t.height):t.height===0?e.fillRect(t.x-.5,t.y,t.width,1):(e.fillRect(t.x-.5,t.y,t.width,t.height),a!=="none"&&e.strokeRect(t.x,t.y,t.width,t.height))})})})},this.getCandleData=(e,c,i,l)=>{const{fill:u,stroke:d,yAccessor:h,wickStroke:f}=this.props,m=w(u),y=w(d),r=w(f),o=.5*w(this.props.width)(this.props,{xScale:c,xAccessor:e,plotData:l});return l.filter(t=>h(t)!==void 0).map(t=>{const n=h(t);if(n===void 0)return;const S=e(t),C=c(S),k=Math.round(i(Math.max(n.open,n.close))),E=Math.max(1,Math.round(Math.abs(i(n.open)-i(n.close))));return{x:C-o,y:k,wick:{stroke:r(n),x:C,y1:Math.round(i(n.high)),y2:k,y3:k+E,y4:Math.round(i(n.low))},height:E,width:o*2,fill:m(n),stroke:y(n),direction:n.close-n.open}}).filter(t=>t!==void 0)}}render(){const{clip:e}=this.props;return M.createElement(D,{clip:e,canvasDraw:this.drawOnCanvas,canvasToDraw:v,drawOn:["pan"]})}}g.defaultProps={candleStrokeWidth:.5,clip:!0,fill:s=>s.close>s.open?"#26a69a":"#ef5350",stroke:"none",wickStroke:s=>s.close>s.open?"#26a69a":"#ef5350",width:x,widthRatio:.8,yAccessor:s=>({open:s.open,high:s.high,low:s.low,close:s.close})};export{g as C};
