import{r as T}from"./index-CTzypqlY.js";import{c as C,a as W}from"./array-2GBN5xbU.js";import{k as A,d as O,G as L,g as N,b as I}from"./withSize-Bqu-aQP_.js";const x=Math.PI,S=2*x,M=1e-6,q=S-M;function D(s){this._+=s[0];for(let t=1,n=s.length;t<n;++t)this._+=arguments[t]+s[t]}function G(s){let t=Math.floor(s);if(!(t>=0))throw new Error(`invalid digits: ${s}`);if(t>15)return D;const n=10**t;return function(e){this._+=e[0];for(let r=1,o=e.length;r<o;++r)this._+=Math.round(arguments[r]*n)/n+e[r]}}class R{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?D:G(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,e,r){this._append`Q${+t},${+n},${this._x1=+e},${this._y1=+r}`}bezierCurveTo(t,n,e,r,o,l){this._append`C${+t},${+n},${+e},${+r},${this._x1=+o},${this._y1=+l}`}arcTo(t,n,e,r,o){if(t=+t,n=+n,e=+e,r=+r,o=+o,o<0)throw new Error(`negative radius: ${o}`);let l=this._x1,h=this._y1,i=e-t,a=r-n,u=l-t,f=h-n,c=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(c>M)if(!(Math.abs(f*i-a*u)>M)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let d=e-l,v=r-h,$=i*i+a*a,m=d*d+v*v,g=Math.sqrt($),_=Math.sqrt(c),p=o*Math.tan((x-Math.acos(($+c-m)/(2*g*_)))/2),y=p/_,w=p/g;Math.abs(y-1)>M&&this._append`L${t+y*u},${n+y*f}`,this._append`A${o},${o},0,0,${+(f*d>u*v)},${this._x1=t+w*i},${this._y1=n+w*a}`}}arc(t,n,e,r,o,l){if(t=+t,n=+n,e=+e,l=!!l,e<0)throw new Error(`negative radius: ${e}`);let h=e*Math.cos(r),i=e*Math.sin(r),a=t+h,u=n+i,f=1^l,c=l?r-o:o-r;this._x1===null?this._append`M${a},${u}`:(Math.abs(this._x1-a)>M||Math.abs(this._y1-u)>M)&&this._append`L${a},${u}`,e&&(c<0&&(c=c%S+S),c>q?this._append`A${e},${e},0,1,${f},${t-h},${n-i}A${e},${e},0,1,${f},${this._x1=a},${this._y1=u}`:c>M&&this._append`A${e},${e},0,${+(c>=x)},${f},${this._x1=t+e*Math.cos(o)},${this._y1=n+e*Math.sin(o)}`)}rect(t,n,e,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${e=+e}v${+r}h${-e}Z`}toString(){return this._}}function U(s){let t=3;return s.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError(`invalid digits: ${n}`);t=e}return s},()=>new R(t)}function P(s){this._context=s}P.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(s,t){switch(s=+s,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(s,t):this._context.moveTo(s,t);break;case 1:this._point=2;default:this._context.lineTo(s,t);break}}};function Y(s){return new P(s)}function Z(s){return s[0]}function j(s){return s[1]}function z(s,t){var n=C(!0),e=null,r=Y,o=null,l=U(h);s=typeof s=="function"?s:s===void 0?Z:C(s),t=typeof t=="function"?t:t===void 0?j:C(t);function h(i){var a,u=(i=W(i)).length,f,c=!1,d;for(e==null&&(o=r(d=l())),a=0;a<=u;++a)!(a<u&&n(f=i[a],a,i))===c&&((c=!c)?o.lineStart():o.lineEnd()),c&&o.point(+s(f,a,i),+t(f,a,i));if(d)return o=null,d+""||null}return h.x=function(i){return arguments.length?(s=typeof i=="function"?i:C(+i),h):s},h.y=function(i){return arguments.length?(t=typeof i=="function"?i:C(+i),h):t},h.defined=function(i){return arguments.length?(n=typeof i=="function"?i:C(!!i),h):n},h.curve=function(i){return arguments.length?(r=i,e!=null&&(o=r(e)),h):r},h.context=function(i){return arguments.length?(i==null?e=o=null:o=r(e=i),h):e},h}class k extends T.Component{constructor(){super(...arguments),this.drawOnCanvas=t=>(n,e)=>{const{connectNulls:r,yAccessor:o,hoverStrokeWidth:l=k.defaultProps.hoverStrokeWidth,defined:h=k.defaultProps.defined,curve:i,canvasClip:a,strokeStyle:u,strokeWidth:f=k.defaultProps.strokeWidth}=this.props,{xAccessor:c,xScale:d,chartConfig:v,plotData:$,hovering:m}=e;if(!v){console.warn("LineSeries received no chartConfig, is it inside of a Chart?");return}const{yScale:g}=v;a!==void 0&&(n.save(),a(n,e)),n.lineWidth=m?l:f,u!==void 0&&(n.strokeStyle=u),t!==void 0&&n.setLineDash(t);const _=z().x(p=>Math.round(d(c(p)))).y(p=>Math.round(g(o(p))));i!==void 0&&_.curve(i),r||_.defined(p=>h(o(p))),n.beginPath(),_.context(n)($),n.stroke(),a!==void 0&&n.restore()},this.isHover=t=>{const{highlightOnHover:n,yAccessor:e,hoverTolerance:r=k.defaultProps.hoverTolerance}=this.props;if(!n)return!1;const{chartConfig:{yScale:o,origin:l},xAccessor:h,mouseXY:i,currentItem:a,xScale:u,plotData:f}=t,[c,d]=i,v=r,{left:$,right:m}=A(f,u.invert(c),h);if($===m){const g=o(e(a))+l[1],_=u(h(a))+l[0];return Math.pow(c-_,2)+Math.pow(d-g,2)<Math.pow(v,2)}else{const g=f[$],_=f[m],p=u(h(g))+l[0],y=o(e(g))+l[1],w=u(h(_))+l[0],b=(o(e(_))+l[1]-y)/(w-p),E=-1*b*p+y,H=Math.round(b*c+E);return d>=H-v&&d<=H+v}}}render(){const{highlightOnHover:t,onClick:n,onContextMenu:e,onDoubleClick:r,onHover:o,onUnHover:l,strokeDasharray:h}=this.props,i=t||o||l?{isHover:this.isHover,drawOn:["mousemove","pan"],canvasToDraw:N}:{drawOn:["pan"],canvasToDraw:I},a=O(h);return T.createElement(L,Object.assign({canvasDraw:this.drawOnCanvas(a),onClickWhenHover:n,onDoubleClickWhenHover:r,onContextMenuWhenHover:e,onHover:o,onUnHover:l},i))}}k.defaultProps={connectNulls:!1,defined:s=>s!==void 0&&!isNaN(s),hoverStrokeWidth:4,hoverTolerance:6,highlightOnHover:!1,strokeDasharray:"Solid",strokeStyle:"#2196f3",strokeWidth:1};export{k as L,Y as c,z as l,U as w,Z as x,j as y};
