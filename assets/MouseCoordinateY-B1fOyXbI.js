import{r as P}from"./index-CTzypqlY.js";import{p as H,d as Y,c as z,G as L,g as X}from"./withSize-Bqu-aQP_.js";const q=e=>{const{coordinate:o,show:n,type:s,orient:r,edgeAt:i,hideLine:u,lineStrokeDasharray:h,fill:t,fontFamily:l,fontSize:f,textFill:c,lineStroke:T,stroke:d,strokeWidth:a,arrowWidth:p,rectWidth:g,rectHeight:m,rectRadius:C,x1:y,y1:k,x2:A,y2:D,dx:v}=e;if(!n)return null;let W,F;if(o!==void 0){const R="middle";let S,w,B,b;if(s==="horizontal")S=v+(r==="right"?i+1:i-g-1),w=k-m/2-a,B=v+(r==="right"?i+g/2:i-g/2),b=k;else{const O=r==="bottom"?a-1:-a+1;S=y-g/2,w=(r==="bottom"?i:i-m)+O,B=y,b=(r==="bottom"?i+m/2:i-m/2)+O}W={edgeXRect:S,edgeYRect:w,rectHeight:m+a,rectWidth:g,rectRadius:C,fill:t,arrowWidth:p,stroke:d,strokeWidth:a},F={edgeXText:B,edgeYText:b,textAnchor:R,fontFamily:l,fontSize:f,textFill:c,displayCoordinate:o}}return{coordinateBase:W,coordinate:F,line:u?void 0:{stroke:T,strokeDasharray:h,x1:y,y1:k,x2:A,y2:D},orient:r}},M=(e,o)=>{const{coordinate:n,fitToText:s,fontSize:r,fontFamily:i,rectWidth:u}=o;e.font=`${r}px ${i}`,e.textBaseline="middle";let h=u;s&&(h=Math.round(e.measureText(n).width+10));const t=q(Object.assign(Object.assign({},o),{rectWidth:h}));if(t!==null){if(t.line!==void 0&&H(t.line)){const l=Y(t.line.strokeDasharray);e.setLineDash(l),e.strokeStyle=t.line.stroke,e.lineWidth=1,e.beginPath(),e.moveTo(t.line.x1,t.line.y1),e.lineTo(t.line.x2,t.line.y2),e.stroke()}if(e.setLineDash([]),t.coordinateBase!==void 0){const{arrowWidth:l,rectWidth:f,rectHeight:c,rectRadius:T}=t.coordinateBase;e.fillStyle=t.coordinateBase.fill,t.coordinateBase.stroke!==void 0&&(e.strokeStyle=t.coordinateBase.stroke,e.lineWidth=t.coordinateBase.strokeWidth);let d=t.coordinateBase.edgeXRect;const a=t.coordinateBase.edgeYRect,p=c/2;e.beginPath(),l>0&&t.orient==="right"?(d-=l,e.moveTo(d,a+p),e.lineTo(d+l,a),e.lineTo(d+f+l,a),e.lineTo(d+f+l,a+c),e.lineTo(d+l,a+c),e.closePath()):l>0&&t.orient==="left"?(e.moveTo(d,a),e.lineTo(d+f,a),e.lineTo(d+f+l,a+p),e.lineTo(d+f,a+c),e.lineTo(d,a+c),e.closePath()):T?E(e,d-.5,a-.5,f,c,3):e.rect(d-.5,a,f,c),e.fill(),t.coordinateBase.stroke!==void 0&&e.stroke(),t.coordinate!==void 0&&(e.fillStyle=t.coordinate.textFill,e.textAlign=t.coordinate.textAnchor==="middle"?"center":t.coordinate.textAnchor,e.fillText(t.coordinate.displayCoordinate,t.coordinate.edgeXText,t.coordinate.edgeYText))}}},E=(e,o,n,s,r,i)=>{e.beginPath(),e.moveTo(o+i,n),e.lineTo(o+s-i,n),e.quadraticCurveTo(o+s,n,o+s,n+i),e.lineTo(o+s,n+r-i),e.quadraticCurveTo(o+s,n+r,o+s-i,n+r),e.lineTo(o+i,n+r),e.quadraticCurveTo(o,n+r,o,n+r-i),e.lineTo(o,n+i),e.quadraticCurveTo(o,n,o+i,n),e.closePath()};class j extends P.Component{constructor(){super(...arguments),this.drawOnCanvas=(o,n)=>{const s=this.helper(this.props,n);s!==void 0&&M(o,s)},this.helper=(o,n)=>{const{chartConfig:{yScale:s},chartId:r,currentItem:i,currentCharts:u,mouseXY:h,show:t}=n;if(!t||z(h)||u.indexOf(r)<0)return;const{displayFormat:l,yAccessor:f}=o;if(f&&!i)return;const c=f?s(f(i)):h[1],T=l(s.invert(c));return G(c,T,o,n)}}render(){return P.createElement(L,{clip:!1,canvasDraw:this.drawOnCanvas,canvasToDraw:X,drawOn:["mousemove","pan","drag"]})}}j.defaultProps={arrowWidth:0,at:"right",dx:0,fill:"#4C525E",fitToText:!1,fontFamily:"-apple-system, system-ui, Roboto, 'Helvetica Neue', Ubuntu, sans-serif",fontSize:13,opacity:1,orient:"right",rectWidth:50,rectHeight:20,strokeOpacity:1,strokeWidth:1,textFill:"#FFFFFF",yAxisPad:0};function G(e,o,n,s){const{width:r}=s,{orient:i,at:u,rectWidth:h,rectHeight:t,dx:l,stroke:f,strokeOpacity:c,strokeWidth:T}=n,{fill:d,opacity:a,fitToText:p,fontFamily:g,fontSize:m,textFill:C,arrowWidth:y}=n;return{coordinate:o,show:!0,fitToText:p,type:"horizontal",orient:i,edgeAt:u==="right"?r:0,hideLine:!0,fill:d,opacity:a,fontFamily:g,fontSize:m,textFill:C,stroke:f,strokeOpacity:c,strokeWidth:T,rectWidth:h,rectHeight:t,arrowWidth:y,dx:l,x1:0,x2:r,y1:e,y2:e}}export{j as M,M as d};
