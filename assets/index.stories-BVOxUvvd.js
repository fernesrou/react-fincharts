import{r as o}from"./index-CTzypqlY.js";import{A as Q,a as Z}from"./AreaOnlySeries-C6tSr0xD.js";import{L as B}from"./LineSeries-Da9A-Bbt.js";import{w as ee}from"./withOHLCData-BEr55ucm.js";import{b as te,r as x}from"./baseIndicator-qdS_KWkb.js";import{e as re}from"./ema-YsYnLjx4.js";import{B as I}from"./defaultOptionsForComputation-CN7nWbKN.js";import{s as $}from"./slidingWindow-Zblwndst.js";import{m as oe}from"./mean-DHO-D6Gx.js";import{z as se,m as ne}from"./merge-WqXt2Bz7.js";import{p as ie}from"./path-uFnBsLuY.js";import{L as w}from"./LineSeries-5eeGgUw4.js";import{T as ae,a as ce}from"./ToolTipTSpanLabel-D8pipyNG.js";import{l as le,f as de,G as me,a as pe,w as ue,m as fe,n as ye,o as ge,X as he,Y as be}from"./withSize-Bqu-aQP_.js";import{d as Ae}from"./discontinuousTimeScaleProvider-DjLVsG-0.js";import{C as Se}from"./CandlestickSeries-CTmIVn2R.js";import"./array-2GBN5xbU.js";import"./index-kspPnZk0.js";import"./functor-Bsi8uwFK.js";import"./jsx-runtime-D_zvdyIk.js";import"./group-CTbjIu5X.js";import"./barWidth-H00B5QnB.js";function Ee(n,t){let e=0,r,s=0,a=0;if(t===void 0)for(let i of n)i!=null&&(i=+i)>=i&&(r=i-s,s+=r/++e,a+=r*(i-s));else{let i=-1;for(let c of n)(c=t(c,++i,n))!=null&&(c=+c)>=c&&(r=c-s,s+=r/++e,a+=r*(c-s))}if(e>1)return a/(e-1)}function Fe(n,t){const e=Ee(n,t);return e&&Math.sqrt(e)}function ve(){let n=I;const t=e=>{const{windowSize:r,multiplier:s,movingAverageType:a,sourcePath:i}=n,c=ie(i),m=a==="ema"?re().options({windowSize:r,sourcePath:i}):$().windowSize(r).accumulator(l=>oe(l)).sourcePath(i),h=$().windowSize(r).accumulator(l=>{const d=l[l.length-1].mean,u=Fe(l,f=>c(f.datum));if(u!==void 0)return{top:d+s*u,middle:d,bottom:d-s*u}}),b=se().combine((l,d)=>({datum:l,mean:d}))(e,m(e));return h(b)};return t.undefinedLength=()=>{const{windowSize:e}=n;return e-1},t.options=e=>e===void 0?n:(n=Object.assign(Object.assign({},I),e),t),t}const z="BollingerBand";function Be(){const n=te().type(z),t=ve(),e=ne().algorithm(t).merge((s,a)=>{s.bollingerBand=a}),r=(s,a={merge:!0})=>{if(a.merge){if(!n.accessor())throw new Error(`Set an accessor to ${z} before calculating`);return e(s)}return t(s)};return x(r,n,"id","accessor","stroke","fill","echo","type"),x(r,t,"options"),x(r,e,"merge","skipUndefined"),r}let L=class g extends o.Component{constructor(){super(...arguments),this.yAccessorForScaledBottom=(t,e)=>{const{yAccessor:r=g.defaultProps.yAccessor}=this.props,s=r(e);if(s!==void 0)return t(s.bottom)},this.yAccessorForBottom=t=>{const{yAccessor:e=g.defaultProps.yAccessor}=this.props,r=e(t);if(r!==void 0)return r.bottom},this.yAccessorForMiddle=t=>{const{yAccessor:e=g.defaultProps.yAccessor}=this.props,r=e(t);if(r!==void 0)return r.middle},this.yAccessorForTop=t=>{const{yAccessor:e=g.defaultProps.yAccessor}=this.props,r=e(t);if(r!==void 0)return r.top}}render(){const{className:t,strokeStyle:e=g.defaultProps.strokeStyle,fillStyle:r}=this.props;return o.createElement("g",{className:t},o.createElement(w,{yAccessor:this.yAccessorForTop,strokeStyle:e.top}),o.createElement(w,{yAccessor:this.yAccessorForMiddle,strokeStyle:e.middle}),o.createElement(w,{yAccessor:this.yAccessorForBottom,strokeStyle:e.bottom}),o.createElement(Q,{yAccessor:this.yAccessorForTop,base:this.yAccessorForScaledBottom,fillStyle:r}))}};L.defaultProps={areaClassName:"react-financial-charts-bollinger-band-series-area",fillStyle:"rgba(38, 166, 153, 0.05)",strokeStyle:{top:"#26a69a",middle:"#812828",bottom:"#26a69a"},yAccessor:n=>n.bb};class A extends o.Component{constructor(){super(...arguments),this.renderSVG=t=>{var e;const{onClick:r,displayFormat:s,yAccessor:a=A.defaultProps.yAccessor,options:i,origin:c,textFill:m,labelFill:h,labelFontWeight:y,className:b,displayValuesFor:l=A.defaultProps.displayValuesFor,displayInit:d,fontFamily:u,fontSize:f,fontWeight:v}=this.props,{chartConfig:k,fullData:q}=t;if(!k)return null;const{width:O,height:G}=k,C=(e=l(this.props,t))!==null&&e!==void 0?e:le(q);let N=d,T=d,_=d;if(C!==void 0){const E=a(C);E!==void 0&&(N=s(E.top),T=s(E.middle),_=s(E.bottom))}const W=de(c),[X,Y]=W(O,G),{sourcePath:j,windowSize:H,multiplier:R,movingAverageType:U}=i,J=`BB(${j}, ${H}, ${R}, ${U}): `,K=`${N}, ${T}, ${_}`;return o.createElement("g",{transform:`translate(${X}, ${Y})`,className:b,onClick:r},o.createElement(ae,{x:0,y:0,fontFamily:u,fontSize:f,fontWeight:v},o.createElement(ce,{fill:h,fontWeight:y},J),o.createElement("tspan",{fill:m},K)))}}render(){return o.createElement(me,{clip:!1,svgDraw:this.renderSVG,drawOn:["mousemove"]})}}A.defaultProps={className:"react-financial-charts-tooltip react-financial-charts-bollingerband-tooltip",displayFormat:pe(".2f"),displayValuesFor:(n,t)=>t.currentItem,displayInit:"n/a",origin:[8,8],yAccessor:n=>n.bb};const p=class p extends o.Component{constructor(){super(...arguments),this.yAccessorForScaledBottom=(t,e)=>{const{yAccessor:r=p.defaultProps.yAccessor}=this.props,s=r(e);if(s!==void 0)return t(s.bottom)},this.yAccessorForBottom=t=>{const{yAccessor:e=p.defaultProps.yAccessor}=this.props,r=e(t);if(r!==void 0)return r.bottom},this.yAccessorForMiddle=t=>{const{yAccessor:e=p.defaultProps.yAccessor}=this.props,r=e(t);if(r!==void 0)return r.middle},this.yAccessorForTop=t=>{const{yAccessor:e=p.defaultProps.yAccessor}=this.props,r=e(t);if(r!==void 0)return r.top}}render(){const{className:t,strokeStyle:e=p.defaultProps.strokeStyle,fillStyle:r}=this.props;return o.createElement("g",{className:t},o.createElement(B,{yAccessor:this.yAccessorForTop,strokeStyle:e.top}),o.createElement(B,{yAccessor:this.yAccessorForMiddle,strokeStyle:e.middle}),o.createElement(B,{yAccessor:this.yAccessorForBottom,strokeStyle:e.bottom}),o.createElement(Z,{yAccessor:this.yAccessorForTop,base:this.yAccessorForScaledBottom,fillStyle:r}))}};p.defaultProps={areaClassName:"react-financial-charts-bollinger-band-series-area",fillStyle:"rgba(38, 166, 153, 0.05)",strokeStyle:{top:"#26a69a",middle:"#812828",bottom:"#26a69a"},yAccessor:t=>t.bb};let S=p;try{S.displayName="BollingerSeries",S.__docgenInfo={description:"",displayName:"BollingerSeries",props:{areaClassName:{defaultValue:{value:"react-financial-charts-bollinger-band-series-area"},description:"",name:"areaClassName",required:!1,type:{name:"string | undefined"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string | undefined"}},fillStyle:{defaultValue:{value:"rgba(38, 166, 153, 0.05)"},description:"",name:"fillStyle",required:!1,type:{name:"string | undefined"}},strokeStyle:{defaultValue:{value:`{
            top: "#26a69a",
            middle: "#812828",
            bottom: "#26a69a",
        }`},description:"",name:"strokeStyle",required:!1,type:{name:"{ top: string; middle: string; bottom: string; } | undefined"}},yAccessor:{defaultValue:{value:"(data: any) => data.bb"},description:"",name:"yAccessor",required:!1,type:{name:"((data: any) => { bottom: number; middle: number; top: number; }) | undefined"}}}}}catch{}class P extends o.Component{constructor(){super(...arguments),this.margin={left:0,right:40,top:8,bottom:24},this.xScaleProvider=Ae().inputDateAccessor(t=>t.date),this.yExtents=t=>[t.bb.top,t.bb.bottom]}render(){const{data:t,height:e,ratio:r,width:s,...a}=this.props,i=Be().merge((f,v)=>{f.bb=v}).accessor(f=>f.bb),c=i(t),{data:m,xScale:h,xAccessor:y,displayXAccessor:b}=this.xScaleProvider(c),l=y(m[m.length-1]),u=[y(m[Math.max(0,m.length-100)]),l];return o.createElement(ye,{height:e,ratio:r,width:s,margin:this.margin,data:m,displayXAccessor:b,seriesName:"Data",xScale:h,xAccessor:y,xExtents:u},o.createElement(ge,{id:1,yExtents:this.yExtents},o.createElement(he,null),o.createElement(be,null),o.createElement(Se,null),o.createElement(L,{...a}),o.createElement(A,{options:i.options()})))}}const xe=ee()(ue()(fe()(P)));try{P.displayName="BollingerIndicator",P.__docgenInfo={description:"",displayName:"BollingerIndicator",props:{fillStyle:{defaultValue:null,description:"",name:"fillStyle",required:!1,type:{name:"string | undefined"}}}}}catch{}try{componentDidMount.displayName="componentDidMount",componentDidMount.__docgenInfo={description:"Called immediately after a component is mounted. Setting state here will trigger re-rendering.",displayName:"componentDidMount",props:{}}}catch{}const Re={title:"Visualization/Indicator/Bollinger Band",component:S,argTypes:{fillStyle:{control:"color"},strokeStyle:{control:!1}}},F={render:({fillStyle:n})=>o.createElement(xe,{fillStyle:n})};var D,V,M;F.parameters={...F.parameters,docs:{...(D=F.parameters)==null?void 0:D.docs,source:{originalSource:`{
  render: ({
    fillStyle
  }) => <BollingerIndicator fillStyle={fillStyle} />
}`,...(M=(V=F.parameters)==null?void 0:V.docs)==null?void 0:M.source}}};const Ue=["basic"];export{Ue as __namedExportsOrder,F as basic,Re as default};
