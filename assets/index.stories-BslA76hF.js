import{r as s}from"./index-CTzypqlY.js";import{L as P}from"./LineSeries-Da9A-Bbt.js";import{S as D}from"./StraightLine-CBnew9DE.js";import{S as X,a as Y}from"./SVGComponent-CW3kryWw.js";import{w as j}from"./withOHLCData-BEr55ucm.js";import{b as H,r as E}from"./baseIndicator-qdS_KWkb.js";import{b as A}from"./defaultOptionsForComputation-CN7nWbKN.js";import{s as B}from"./slidingWindow-Zblwndst.js";import{m as V}from"./mean-DHO-D6Gx.js";import{p as U}from"./path-uFnBsLuY.js";import{m as J}from"./merge-WqXt2Bz7.js";import{L as W}from"./LineSeries-5eeGgUw4.js";import{S as T}from"./StraightLine-BDDeJkOw.js";import{T as K,a as Q}from"./ToolTipTSpanLabel-D8pipyNG.js";import{p as Z,f as ee,G as te,a as re,w as oe,m as se,n as ie,o as ne,X as ae,Y as le}from"./withSize-Bqu-aQP_.js";import{d as de}from"./discontinuousTimeScaleProvider-DjLVsG-0.js";import"./index-kspPnZk0.js";import"./functor-Bsi8uwFK.js";import"./array-2GBN5xbU.js";import"./jsx-runtime-D_zvdyIk.js";function ce(){let d=A;const e=r=>{const{windowSize:t,sourcePath:o}=d,i=U(o);let n,a;const l=B().windowSize(t).accumulator(c=>{const h=n!==void 0?(n*(t-1)+c[c.length-1].gain)/t:V(c,g=>g.gain);if(h===void 0)return;const m=a!==void 0?(a*(t-1)+c[c.length-1].loss)/t:V(c,g=>g.loss);if(m===void 0)return;const v=100-100/(1+h/m);return n=h,a=m,v}),f=B().windowSize(2).undefinedValue(()=>[0,0]).accumulator(c=>{const h=c[0],m=c[1],p=i(m)-i(h);return{gain:Math.max(p,0),loss:Math.abs(Math.min(p,0))}})(r);return l(f)};return e.undefinedLength=()=>{const{windowSize:r}=d;return r-1},e.options=r=>r===void 0?d:(d=Object.assign(Object.assign({},A),r),e),e}const _="RSI";function he(){const d=H().type(_).accessor(o=>o.rsi),e=ce(),r=J().algorithm(e).merge((o,i)=>{o.rsi=i}),t=(o,i={merge:!0})=>{if(i.merge){if(!d.accessor())throw new Error(`Set an accessor to ${_} before calculating`);return r(o)}return e(o)};return E(t,d,"id","accessor","stroke","fill","echo","type"),E(t,e,"options","undefinedLength"),E(t,r,"merge","skipUndefined"),t}let M=class k extends s.Component{constructor(){super(...arguments),this.clipPathId1=`rsi-clip-${String(Math.round(Math.random()*1e4*1e4))}`,this.clipPathId2=`rsi-clip-${String(Math.round(Math.random()*1e4*1e4))}`,this.renderClip=e=>{const{chartConfig:r}=e;if(!r)return null;const{overSold:t,overBought:o}=this.props,{yScale:i,width:n,height:a}=r;return s.createElement("defs",null,s.createElement("clipPath",{id:this.clipPathId1},s.createElement("rect",{x:0,y:i(t),width:n,height:i(o)-i(t)})),s.createElement("clipPath",{id:this.clipPathId2},s.createElement("rect",{x:0,y:0,width:n,height:i(t)}),s.createElement("rect",{x:0,y:i(o),width:n,height:a-i(o)})))},this.mainClip=(e,r)=>{const{chartConfig:t}=r;if(!t)return;const{overSold:o,overBought:i}=this.props,{yScale:n,width:a,height:l}=t;e.beginPath(),e.rect(0,0,a,n(o)),e.rect(0,n(i),a,l-n(i)),e.clip()},this.topAndBottomClip=(e,r)=>{const{chartConfig:t}=r;if(!t)return;const{overSold:o,overBought:i}=this.props,{yScale:n,width:a}=t;e.beginPath(),e.rect(0,n(o),a,n(i)-n(o)),e.clip()}}render(){const{className:e,strokeStyle:r=k.defaultProps.strokeStyle,strokeDasharray:t=k.defaultProps.strokeDasharray,strokeWidth:o=k.defaultProps.strokeWidth}=this.props,{yAccessor:i}=this.props,{overSold:n,middle:a,overBought:l}=this.props;return s.createElement("g",{className:e},s.createElement(X,null,this.renderClip),s.createElement(T,{strokeStyle:r.top,yValue:n,lineDash:t.top,lineWidth:o.top}),s.createElement(T,{strokeStyle:r.middle,yValue:a,lineDash:t.middle,lineWidth:o.middle}),s.createElement(T,{strokeStyle:r.bottom,yValue:l,lineDash:t.bottom,lineWidth:o.bottom}),s.createElement(W,{canvasClip:this.topAndBottomClip,yAccessor:i,strokeStyle:r.insideThreshold||r.line,strokeWidth:o.insideThreshold,strokeDasharray:t.line}),s.createElement(W,{canvasClip:this.mainClip,yAccessor:i,strokeStyle:r.outsideThreshold||r.line,strokeWidth:o.outsideThreshold,strokeDasharray:t.line}))}};M.defaultProps={className:"react-financial-charts-rsi-series",strokeStyle:{line:"#000000",top:"#B8C2CC",middle:"#8795A1",bottom:"#B8C2CC",outsideThreshold:"#b300b3",insideThreshold:"#ffccff"},strokeDasharray:{line:"Solid",top:"ShortDash",middle:"ShortDash",bottom:"ShortDash"},strokeWidth:{outsideThreshold:1,insideThreshold:1,top:1,middle:1,bottom:1},overSold:70,middle:50,overBought:30};class N extends s.Component{constructor(){super(...arguments),this.renderSVG=e=>{const{onClick:r,displayInit:t,fontFamily:o,fontSize:i,fontWeight:n,yAccessor:a,displayFormat:l,className:S,options:f,labelFill:b,labelFontWeight:c,textFill:h,displayValuesFor:m}=this.props,{chartConfig:p}=e;if(!p)return null;const{width:v,height:g}=p,I=m(this.props,e),w=Z(I)&&a(I),$=w&&l(w)||t,{origin:z}=this.props,F=ee(z),[G,q]=F(v,g),O=`RSI (${f.windowSize}): `;return s.createElement("g",{className:S,transform:`translate(${G}, ${q})`,onClick:r},s.createElement(K,{x:0,y:0,fontFamily:o,fontSize:i,fontWeight:n},s.createElement(Q,{fill:b,fontWeight:c},O),s.createElement("tspan",{fill:h},$)))}}render(){return s.createElement(te,{clip:!1,svgDraw:this.renderSVG,drawOn:["mousemove"]})}}N.defaultProps={displayFormat:re(".2f"),displayInit:"n/a",displayValuesFor:(d,e)=>e.currentItem,origin:[0,0],className:"react-financial-charts-tooltip"};const u=class u extends s.Component{constructor(){super(...arguments),this.clipPathId1=`rsi-clip-${String(Math.round(Math.random()*1e4*1e4))}`,this.clipPathId2=`rsi-clip-${String(Math.round(Math.random()*1e4*1e4))}`,this.renderClip=e=>{const{chartConfig:r}=e;if(!r)return null;const{overSold:t,overBought:o}=this.props,{yScale:i,width:n,height:a}=r;return s.createElement("defs",null,s.createElement("clipPath",{id:this.clipPathId1},s.createElement("rect",{x:0,y:i(t),width:n,height:i(o)-i(t)})),s.createElement("clipPath",{id:this.clipPathId2},s.createElement("rect",{x:0,y:0,width:n,height:i(t)}),s.createElement("rect",{x:0,y:i(o),width:n,height:a-i(o)})))},this.mainClip=(e,r)=>{const{chartConfig:t}=r;if(!t)return;const{overSold:o,overBought:i}=this.props,{yScale:n,width:a,height:l}=t;e.beginPath(),e.rect(0,0,a,n(o)),e.rect(0,n(i),a,l-n(i)),e.clip()},this.topAndBottomClip=(e,r)=>{const{chartConfig:t}=r;if(!t)return;const{overSold:o,overBought:i}=this.props,{yScale:n,width:a}=t;e.beginPath(),e.rect(0,n(o),a,n(i)-n(o)),e.clip()}}render(){const{className:e,strokeStyle:r=u.defaultProps.strokeStyle,strokeDasharray:t=u.defaultProps.strokeDasharray,strokeWidth:o=u.defaultProps.strokeWidth}=this.props,{yAccessor:i}=this.props,{overSold:n,middle:a,overBought:l}=this.props;return s.createElement("g",{className:e},s.createElement(Y,null,this.renderClip),s.createElement(D,{strokeStyle:r.top,yValue:n,lineDash:t.top,lineWidth:o.top}),s.createElement(D,{strokeStyle:r.middle,yValue:a,lineDash:t.middle,lineWidth:o.middle}),s.createElement(D,{strokeStyle:r.bottom,yValue:l,lineDash:t.bottom,lineWidth:o.bottom}),s.createElement(P,{canvasClip:this.topAndBottomClip,yAccessor:i,strokeStyle:r.insideThreshold||r.line,strokeWidth:o.insideThreshold,strokeDasharray:t.line}),s.createElement(P,{canvasClip:this.mainClip,yAccessor:i,strokeStyle:r.outsideThreshold||r.line,strokeWidth:o.outsideThreshold,strokeDasharray:t.line}))}};u.defaultProps={className:"react-financial-charts-rsi-series",strokeStyle:{line:"#000000",top:"#B8C2CC",middle:"#8795A1",bottom:"#B8C2CC",outsideThreshold:"#b300b3",insideThreshold:"#ffccff"},strokeDasharray:{line:"Solid",top:"ShortDash",middle:"ShortDash",bottom:"ShortDash"},strokeWidth:{outsideThreshold:1,insideThreshold:1,top:1,middle:1,bottom:1},overSold:70,middle:50,overBought:30};let y=u;try{y.displayName="RSISeries",y.__docgenInfo={description:"The Relative Strength Index (RSI) is a momentum oscillator that measures the speed and change of price movements.",displayName:"RSISeries",props:{className:{defaultValue:{value:"react-financial-charts-rsi-series"},description:"",name:"className",required:!1,type:{name:"string | undefined"}},yAccessor:{defaultValue:null,description:"",name:"yAccessor",required:!0,type:{name:"(data: any) => any"}},strokeStyle:{defaultValue:{value:`{
            line: "#000000",
            top: "#B8C2CC",
            middle: "#8795A1",
            bottom: "#B8C2CC",
            outsideThreshold: "#b300b3",
            insideThreshold: "#ffccff",
        }`},description:"",name:"strokeStyle",required:!1,type:{name:"{ line: string; top: string; middle: string; bottom: string; outsideThreshold: string; insideThreshold: string; } | undefined"}},strokeDasharray:{defaultValue:{value:`{
            line: "Solid" as strokeDashTypes,
            top: "ShortDash" as strokeDashTypes,
            middle: "ShortDash" as strokeDashTypes,
            bottom: "ShortDash" as strokeDashTypes,
        }`},description:"",name:"strokeDasharray",required:!1,type:{name:"{ line: strokeDashTypes; top: strokeDashTypes; middle: strokeDashTypes; bottom: strokeDashTypes; } | undefined"}},strokeWidth:{defaultValue:{value:`{
            outsideThreshold: 1,
            insideThreshold: 1,
            top: 1,
            middle: 1,
            bottom: 1,
        }`},description:"",name:"strokeWidth",required:!1,type:{name:"{ outsideThreshold: number; insideThreshold: number; top: number; middle: number; bottom: number; } | undefined"}},overSold:{defaultValue:{value:"70"},description:"",name:"overSold",required:!1,type:{name:"number | undefined"}},middle:{defaultValue:{value:"50"},description:"",name:"middle",required:!1,type:{name:"number | undefined"}},overBought:{defaultValue:{value:"30"},description:"",name:"overBought",required:!1,type:{name:"number | undefined"}}}}}catch{}class me extends s.Component{constructor(){super(...arguments),this.margin={left:0,right:40,top:0,bottom:24},this.xScaleProvider=de().inputDateAccessor(e=>e.date),this.rsiCalculator=he().options({windowSize:14}).merge((e,r)=>{e.rsi=r}).accessor(e=>e.rsi)}render(){const{data:e,height:r,ratio:t,width:o}=this.props,i=this.rsiCalculator(e),{data:n,xScale:a,xAccessor:l,displayXAccessor:S}=this.xScaleProvider(i),f=l(n[n.length-1]),c=[l(n[Math.max(0,n.length-100)]),f],h=this.rsiCalculator.accessor();return s.createElement(ie,{height:r,ratio:t,width:o,margin:this.margin,data:n,displayXAccessor:S,seriesName:"Data",xScale:a,xAccessor:l,xExtents:c},s.createElement(ne,{id:1,yExtents:[0,100]},s.createElement(ae,null),s.createElement(le,{tickValues:[30,50,70]}),s.createElement(M,{yAccessor:h}),s.createElement(N,{origin:[8,16],yAccessor:h,options:this.rsiCalculator.options()})))}}const pe=j()(oe()(se()(me)));try{RsiIndicator.displayName="RsiIndicator",RsiIndicator.__docgenInfo={description:"",displayName:"RsiIndicator",props:{}}}catch{}try{componentDidMount.displayName="componentDidMount",componentDidMount.__docgenInfo={description:"Called immediately after a component is mounted. Setting state here will trigger re-rendering.",displayName:"componentDidMount",props:{}}}catch{}const xe={title:"Visualization/Indicator/RSI",component:y},C=()=>s.createElement(pe,null);var x,R,L;C.parameters={...C.parameters,docs:{...(x=C.parameters)==null?void 0:x.docs,source:{originalSource:"() => <RSIIndicator />",...(L=(R=C.parameters)==null?void 0:R.docs)==null?void 0:L.source}}};const Re=["basic"];export{Re as __namedExportsOrder,C as basic,xe as default};
