import{r}from"./index-CTzypqlY.js";import{B as k}from"./BarSeries-BpSNlv4B.js";import{L as _}from"./LineSeries-Da9A-Bbt.js";import{S as J}from"./StraightLine-CBnew9DE.js";import{w as K}from"./withOHLCData-BEr55ucm.js";import{b as Q,r as E}from"./baseIndicator-qdS_KWkb.js";import{M as x}from"./defaultOptionsForComputation-CN7nWbKN.js";import{e as C}from"./ema-YsYnLjx4.js";import{z as I}from"./zip-Irq_DN6l.js";import{m as Z}from"./merge-WqXt2Bz7.js";import{B}from"./BarSeries-CMNobAzD.js";import{L as z}from"./LineSeries-5eeGgUw4.js";import{S as ee}from"./StraightLine-BDDeJkOw.js";import{T as te,a as h}from"./ToolTipTSpanLabel-D8pipyNG.js";import{l as re,f as ne,G as se,a as ae,w as ie,m as oe,n as ce,o as le,X as de,Y as me}from"./withSize-Bqu-aQP_.js";import{d as pe}from"./discontinuousTimeScaleProvider-DjLVsG-0.js";import"./StackedBarSeries-NufmFq2n.js";import"./group-CTbjIu5X.js";import"./index-kspPnZk0.js";import"./StackedBarSeries-C1rjxMaO.js";import"./array-2GBN5xbU.js";import"./barWidth-H00B5QnB.js";import"./path-uFnBsLuY.js";import"./jsx-runtime-D_zvdyIk.js";function ue(){let o=x;const e=t=>{const{fast:n,slow:s,signal:c,sourcePath:i}=o,y=C().options({windowSize:n,sourcePath:i}),m=C().options({windowSize:s,sourcePath:i}),p=C().options({windowSize:c,sourcePath:void 0}),u=I(y(t),m(t)).map(a=>a[0]!==void 0&&a[1]!==void 0?a[0]-a[1]:void 0),D=p(u);return I(u,D).map(a=>({macd:a[0],signal:a[1],divergence:a[0]!==void 0&&a[1]!==void 0?a[0]-a[1]:void 0}))};return e.undefinedLength=()=>{const{slow:t,signal:n}=o;return t+n-1},e.options=t=>t===void 0?o:(o=Object.assign(Object.assign({},x),t),e),e}const fe={light:{MACD:{fill:{divergence:"#4682B4"},stroke:{macd:"#FF0000",signal:"#00F300"}}}},N=fe.light.MACD,V="MACD";function ge(){const o=Q().type(V).fill(N.fill).stroke(N.stroke).accessor(s=>s.macd),e=ue(),t=Z().algorithm(e).merge((s,c)=>{s.macd=c}),n=(s,c={merge:!0})=>{if(c.merge){if(!o.accessor())throw new Error(`Set an accessor to ${V} before calculating`);return t(s)}return e(s)};return E(n,o,"id","accessor","stroke","fill","echo","type"),E(n,e,"options","undefinedLength"),E(n,t,"merge","skipUndefined"),n}let R=class F extends r.Component{constructor(){super(...arguments),this.yAccessorForDivergenceBase=(e,t)=>t(0),this.yAccessorForDivergence=e=>{const{yAccessor:t}=this.props,n=t(e);if(n!==void 0)return n.divergence},this.yAccessorForSignal=e=>{const{yAccessor:t}=this.props,n=t(e);if(n!==void 0)return n.signal},this.yAccessorForMACD=e=>{const{yAccessor:t}=this.props,n=t(e);if(n!==void 0)return n.macd}}render(){const{className:e,clip:t,fillStyle:n=F.defaultProps.fillStyle,strokeStyle:s=F.defaultProps.strokeStyle,widthRatio:c,width:i}=this.props;return r.createElement("g",{className:e},r.createElement(B,{baseAt:this.yAccessorForDivergenceBase,width:i,widthRatio:c,fillStyle:n.divergence,clip:t,yAccessor:this.yAccessorForDivergence}),r.createElement(z,{yAccessor:this.yAccessorForMACD,strokeStyle:s.macd}),r.createElement(z,{yAccessor:this.yAccessorForSignal,strokeStyle:s.signal}),r.createElement(ee,{strokeStyle:s.zero,yValue:0}))}};R.defaultProps={className:"react-financial-charts-macd-series",clip:!0,fillStyle:{divergence:"rgba(70, 130, 180, 0.6)"},strokeStyle:{macd:"#0093FF",signal:"#D84315",zero:"rgba(0, 0, 0, 0.3)"},widthRatio:.5,width:B.defaultProps.width};class $ extends r.Component{constructor(){super(...arguments),this.renderSVG=e=>{var t;const{onClick:n,displayInit:s,fontFamily:c,fontSize:i,fontWeight:y,displayValuesFor:m,displayFormat:p,className:u,yAccessor:D,options:a,origin:S,appearance:d,labelFill:f,labelFontWeight:g}=this.props,{chartConfig:b,fullData:q}=e;if(!b)return null;const{width:W,height:O}=b,M=(t=m(this.props,e))!==null&&t!==void 0?t:re(q),l=M&&D(M),G=(l==null?void 0:l.macd)&&p(l.macd)||s,X=(l==null?void 0:l.signal)&&p(l.signal)||s,Y=(l==null?void 0:l.divergence)&&p(l.divergence)||s,j=ne(S),[H,U]=j(W,O);return r.createElement("g",{className:u,transform:`translate(${H}, ${U})`,onClick:n},r.createElement(te,{x:0,y:0,fontFamily:c,fontSize:i,fontWeight:y},r.createElement(h,{fill:f,fontWeight:g},"MACD ("),r.createElement("tspan",{fill:d.strokeStyle.macd},a.slow),r.createElement(h,{fill:f,fontWeight:g},","," "),r.createElement("tspan",{fill:d.strokeStyle.macd},a.fast),r.createElement(h,{fill:f,fontWeight:g},"):"," "),r.createElement("tspan",{fill:d.strokeStyle.macd},G),r.createElement(h,{fill:f,fontWeight:g}," ","Signal ("),r.createElement("tspan",{fill:d.strokeStyle.signal},a.signal),r.createElement(h,{fill:f,fontWeight:g},"):"," "),r.createElement("tspan",{fill:d.strokeStyle.signal},X),r.createElement(h,{fill:f,fontWeight:g}," ","Divergence:"," "),r.createElement("tspan",{fill:d.fillStyle.divergence},Y)))}}render(){return r.createElement(se,{clip:!1,svgDraw:this.renderSVG,drawOn:["mousemove"]})}}$.defaultProps={className:"react-financial-charts-tooltip",displayFormat:ae(".2f"),displayInit:"n/a",displayValuesFor:(o,e)=>e.currentItem,origin:[0,0]};const A=class A extends r.Component{constructor(){super(...arguments),this.yAccessorForDivergenceBase=(e,t)=>t(0),this.yAccessorForDivergence=e=>{const{yAccessor:t}=this.props,n=t(e);if(n!==void 0)return n.divergence},this.yAccessorForSignal=e=>{const{yAccessor:t}=this.props,n=t(e);if(n!==void 0)return n.signal},this.yAccessorForMACD=e=>{const{yAccessor:t}=this.props,n=t(e);if(n!==void 0)return n.macd}}render(){const{className:e,clip:t,fillStyle:n=A.defaultProps.fillStyle,strokeStyle:s=A.defaultProps.strokeStyle,widthRatio:c,width:i}=this.props;return r.createElement("g",{className:e},r.createElement(k,{baseAt:this.yAccessorForDivergenceBase,width:i,widthRatio:c,fillStyle:n.divergence,clip:t,yAccessor:this.yAccessorForDivergence}),r.createElement(_,{yAccessor:this.yAccessorForMACD,strokeStyle:s.macd}),r.createElement(_,{yAccessor:this.yAccessorForSignal,strokeStyle:s.signal}),r.createElement(J,{strokeStyle:s.zero,yValue:0}))}};A.defaultProps={className:"react-financial-charts-macd-series",clip:!0,fillStyle:{divergence:"rgba(70, 130, 180, 0.6)"},strokeStyle:{macd:"#0093FF",signal:"#D84315",zero:"rgba(0, 0, 0, 0.3)"},widthRatio:.5,width:k.defaultProps.width};let v=A;try{v.displayName="MACDSeries",v.__docgenInfo={description:"The MACD turns two trend-following indicators, moving averages, into a momentum oscillator by subtracting the longer moving average from the shorter one.",displayName:"MACDSeries",props:{className:{defaultValue:{value:"react-financial-charts-macd-series"},description:"",name:"className",required:!1,type:{name:"string | undefined"}},clip:{defaultValue:{value:"true"},description:"",name:"clip",required:!1,type:{name:"boolean | undefined"}},fillStyle:{defaultValue:{value:`{
            divergence: "rgba(70, 130, 180, 0.6)",
        }`},description:"",name:"fillStyle",required:!1,type:{name:"{ divergence: string; } | undefined"}},strokeStyle:{defaultValue:{value:`{
            macd: "#0093FF",
            signal: "#D84315",
            zero: "rgba(0, 0, 0, 0.3)",
        }`},description:"",name:"strokeStyle",required:!1,type:{name:"{ macd: string; signal: string; zero: string; } | undefined"}},widthRatio:{defaultValue:{value:"0.5"},description:"",name:"widthRatio",required:!1,type:{name:"number | undefined"}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"number | ((props: { widthRatio: number; }, moreProps: any) => number) | undefined"}},yAccessor:{defaultValue:null,description:"",name:"yAccessor",required:!0,type:{name:"(data: any) => { divergence: number; signal: number; macd: number; } | undefined"}},zeroLineStroke:{defaultValue:null,description:"",name:"zeroLineStroke",required:!1,type:{name:"string | undefined"}},zeroLineOpacity:{defaultValue:null,description:"",name:"zeroLineOpacity",required:!1,type:{name:"number | undefined"}}}}}catch{}class he extends r.Component{constructor(){super(...arguments),this.macdAppearance={fillStyle:{divergence:"#4682B4"},strokeStyle:{macd:"#0093FF",signal:"#D84315",zero:"rgba(0, 0, 0, 0.3)"}},this.margin={left:0,right:40,top:0,bottom:24},this.xScaleProvider=pe().inputDateAccessor(e=>e.date),this.macdCalculator=ge().options({fast:12,signal:9,slow:26}).merge((e,t)=>{e.macd=t}).accessor(e=>e.macd)}render(){const{data:e,height:t,ratio:n,width:s}=this.props,c=this.macdCalculator(e),{data:i,xScale:y,xAccessor:m,displayXAccessor:p}=this.xScaleProvider(c),u=m(i[i.length-1]),a=[m(i[Math.max(0,i.length-100)]),u],S=this.macdCalculator.accessor(),d=this.macdCalculator.options();return r.createElement(ce,{height:t,ratio:n,width:s,margin:this.margin,data:i,displayXAccessor:p,seriesName:"Data",xScale:y,xAccessor:m,xExtents:a},r.createElement(le,{id:1,yExtents:S},r.createElement(de,null),r.createElement(me,null),r.createElement(R,{yAccessor:S,...this.macdAppearance}),r.createElement($,{origin:[8,16],appearance:this.macdAppearance,options:d,yAccessor:S})))}}const ye=K()(ie()(oe()(he)));try{MacdIndicator.displayName="MacdIndicator",MacdIndicator.__docgenInfo={description:"",displayName:"MacdIndicator",props:{}}}catch{}try{componentDidMount.displayName="componentDidMount",componentDidMount.__docgenInfo={description:"Called immediately after a component is mounted. Setting state here will trigger re-rendering.",displayName:"componentDidMount",props:{}}}catch{}const We={title:"Visualization/Indicator/MACD",component:v},w=()=>r.createElement(ye,null);var P,L,T;w.parameters={...w.parameters,docs:{...(P=w.parameters)==null?void 0:P.docs,source:{originalSource:"() => <MACDIndicator />",...(T=(L=w.parameters)==null?void 0:L.docs)==null?void 0:T.source}}};const Oe=["basic"];export{Oe as __namedExportsOrder,w as basic,We as default};
