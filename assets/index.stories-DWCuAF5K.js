import{r as e}from"./index-CTzypqlY.js";import{L as $}from"./LineSeries-Da9A-Bbt.js";import{S as z}from"./StraightLine-CBnew9DE.js";import{w as ie}from"./withOHLCData-BEr55ucm.js";import{f as se,G as ne,a as U,w as ae,m as ce,t as le,n as de,o as O,X as C,Y as V}from"./withSize-Bqu-aQP_.js";import{b as me,r as W}from"./baseIndicator-qdS_KWkb.js";import{c as G}from"./defaultOptionsForComputation-CN7nWbKN.js";import{s as I}from"./slidingWindow-Zblwndst.js";import{a as pe,m as ue}from"./merge-WqXt2Bz7.js";import{m as H}from"./mean-DHO-D6Gx.js";import{z as he}from"./zip-Irq_DN6l.js";import{L as q}from"./LineSeries-5eeGgUw4.js";import{S as N}from"./StraightLine-BDDeJkOw.js";import{T as fe,a as L}from"./ToolTipTSpanLabel-D8pipyNG.js";import{d as ge}from"./discontinuousTimeScaleProvider-DjLVsG-0.js";import{M as P}from"./MouseCoordinateY-B1fOyXbI.js";import{M as Se}from"./MouseCoordinateX-BVdS_xjN.js";import{C as ye}from"./CrossHairCursor-C6hnYaC-.js";import"./jsx-runtime-D_zvdyIk.js";import"./index-kspPnZk0.js";import"./functor-Bsi8uwFK.js";import"./path-uFnBsLuY.js";import"./array-2GBN5xbU.js";function we(c,o){let t;if(o===void 0)for(const r of c)r!=null&&(t<r||t===void 0&&r>=r)&&(t=r);else{let r=-1;for(let s of c)(s=o(s,++r,c))!=null&&(t<s||t===void 0&&s>=s)&&(t=s)}return t}function ke(){let c=G,o=r=>({open:r.open,high:r.high,low:r.low,close:r.close});const t=r=>{const{windowSize:s,kWindowSize:a,dWindowSize:E}=c,b=n=>o(n).high,A=n=>o(n).low,g=n=>o(n).close,S=I().windowSize(s).accumulator(n=>{const w=we(n,b);if(w===void 0)return;const p=pe(n,A);return p===void 0?void 0:(g(n[n.length-1])-p)/(w-p)*100}),m=I().skipInitial(s-1).windowSize(a).accumulator(n=>H(n)),F=I().skipInitial(s-1+a-1).windowSize(E).accumulator(n=>H(n)),u=m(S(r)),y=F(u);return he(u,y).map(n=>({K:n[0],D:n[1]}))};return t.undefinedLength=()=>{const{windowSize:r,kWindowSize:s,dWindowSize:a}=c;return r+s+a},t.source=r=>r===void 0?o:(o=r,t),t.options=r=>r===void 0?c:(c=Object.assign(Object.assign({},G),r),t),t}const X="STO";function K(){const c=me().type(X),o=ke(),t=ue().algorithm(o).merge((s,a)=>{s.sto=a}),r=(s,a={merge:!0})=>{if(a.merge){if(!c.accessor())throw new Error(`Set an accessor to ${X} before calculating`);return t(s)}return o(s)};return W(r,c,"id","accessor","stroke","fill","echo","type"),W(r,o,"options","undefinedLength"),W(r,t,"merge","skipUndefined"),r}let f=class J extends e.Component{constructor(){super(...arguments),this.yAccessorForK=o=>{const{yAccessor:t}=this.props;return t(o)&&t(o).K},this.yAccessorForD=o=>{const{yAccessor:t}=this.props;return t(o)&&t(o).D}}render(){const{className:o,strokeStyle:t=J.defaultProps.strokeStyle,overSold:r,middle:s,overBought:a}=this.props;return e.createElement("g",{className:o},e.createElement(q,{yAccessor:this.yAccessorForD,strokeStyle:t.dLine}),e.createElement(q,{yAccessor:this.yAccessorForK,strokeStyle:t.kLine}),e.createElement(N,{strokeStyle:t.top,yValue:r}),e.createElement(N,{strokeStyle:t.middle,yValue:s}),e.createElement(N,{strokeStyle:t.bottom,yValue:a}))}};f.defaultProps={className:"react-financial-charts-stochastic-series",strokeStyle:{top:"rgba(150, 75, 0, 0.3)",middle:"rgba(0, 0, 0, 0.3)",bottom:"rgba(150, 75, 0, 0.3)",dLine:"#EA2BFF",kLine:"#74D400"},overSold:80,middle:50,overBought:20};class k extends e.Component{constructor(){super(...arguments),this.renderSVG=o=>{var t,r,s;const{onClick:a,fontFamily:E,fontSize:b,fontWeight:A,yAccessor:g,displayFormat:S,origin:m,label:F,className:u,displayInit:y,displayValuesFor:x=k.defaultProps.displayValuesFor,options:n,appearance:w,labelFill:p}=this.props,{chartConfig:d,fullData:i}=o;if(!d)return null;const{width:l,height:Q}=d,M=(t=x(this.props,o))!==null&&t!==void 0?t:i[i.length-1],h=M&&g(M),Z=(r=(h==null?void 0:h.K)&&S(h.K))!==null&&r!==void 0?r:y,ee=(s=(h==null?void 0:h.D)&&S(h.D))!==null&&s!==void 0?s:y,te=se(m),[oe,re]=te(l,Q),{stroke:D}=w;return e.createElement("g",{className:u,transform:`translate(${oe}, ${re})`,onClick:a},e.createElement(fe,{x:0,y:0,fontFamily:E,fontSize:b,fontWeight:A},e.createElement(L,{fill:p},`${F} %K(`),e.createElement("tspan",{fill:D.kLine},`${n.windowSize}, ${n.kWindowSize}`),e.createElement(L,{fill:p},"): "),e.createElement("tspan",{fill:D.kLine},Z),e.createElement(L,{fill:p}," %D ("),e.createElement("tspan",{fill:D.dLine},n.dWindowSize),e.createElement(L,{fill:p},"): "),e.createElement("tspan",{fill:D.dLine},ee)))}}render(){return e.createElement(ne,{clip:!1,svgDraw:this.renderSVG,drawOn:["mousemove"]})}}k.defaultProps={className:"react-financial-charts-tooltip",displayFormat:U(".2f"),displayInit:"n/a",displayValuesFor:(c,o)=>o.currentItem,label:"STO",origin:[0,0]};const v=class v extends e.Component{constructor(){super(...arguments),this.yAccessorForK=o=>{const{yAccessor:t}=this.props;return t(o)&&t(o).K},this.yAccessorForD=o=>{const{yAccessor:t}=this.props;return t(o)&&t(o).D}}render(){const{className:o,strokeStyle:t=v.defaultProps.strokeStyle,overSold:r,middle:s,overBought:a}=this.props;return e.createElement("g",{className:o},e.createElement($,{yAccessor:this.yAccessorForD,strokeStyle:t.dLine}),e.createElement($,{yAccessor:this.yAccessorForK,strokeStyle:t.kLine}),e.createElement(z,{strokeStyle:t.top,yValue:r}),e.createElement(z,{strokeStyle:t.middle,yValue:s}),e.createElement(z,{strokeStyle:t.bottom,yValue:a}))}};v.defaultProps={className:"react-financial-charts-stochastic-series",strokeStyle:{top:"rgba(150, 75, 0, 0.3)",middle:"rgba(0, 0, 0, 0.3)",bottom:"rgba(150, 75, 0, 0.3)",dLine:"#EA2BFF",kLine:"#74D400"},overSold:80,middle:50,overBought:20};let T=v;try{T.displayName="StochasticSeries",T.__docgenInfo={description:"The Stochastic Oscillator is a momentum indicator that shows the location of the close relative to the high-low range over a set number of periods.",displayName:"StochasticSeries",props:{className:{defaultValue:{value:"react-financial-charts-stochastic-series"},description:"",name:"className",required:!1,type:{name:"string | undefined"}},overBought:{defaultValue:{value:"20"},description:"",name:"overBought",required:!1,type:{name:"number | undefined"}},overSold:{defaultValue:{value:"80"},description:"",name:"overSold",required:!1,type:{name:"number | undefined"}},middle:{defaultValue:{value:"50"},description:"",name:"middle",required:!1,type:{name:"number | undefined"}},strokeStyle:{defaultValue:{value:`{
            top: "rgba(150, 75, 0, 0.3)",
            middle: "rgba(0, 0, 0, 0.3)",
            bottom: "rgba(150, 75, 0, 0.3)",
            dLine: "#EA2BFF",
            kLine: "#74D400",
        }`},description:"",name:"strokeStyle",required:!1,type:{name:"{ top: string; middle: string; bottom: string; dLine: string; kLine: string; } | undefined"}},yAccessor:{defaultValue:null,description:"",name:"yAccessor",required:!0,type:{name:"(data: any) => { K: number; D: number; }"}}}}}catch{}class B extends e.Component{constructor(){super(...arguments),this.displayFormat=U(".2f"),this.timeDisplayFormat=le("%d %b"),this.margin={left:0,right:40,top:0,bottom:24},this.xScaleProvider=ge().inputDateAccessor(o=>o.date)}render(){const{data:o,height:t,ratio:r,width:s}=this.props,a=K().options({windowSize:14,kWindowSize:3,dWindowSize:3}).merge((i,l)=>{i.slowSTO=l}).accessor(i=>i.slowSTO),E=K().options({windowSize:14,kWindowSize:1,dWindowSize:3}).merge((i,l)=>{i.fastSTO=l}).accessor(i=>i.fastSTO),b=K().options({windowSize:14,kWindowSize:3,dWindowSize:4}).merge((i,l)=>{i.fullSTO=l}).accessor(i=>i.fullSTO),A=a(E(b(o))),{margin:g,xScaleProvider:S}=this,{data:m,xScale:F,xAccessor:u,displayXAccessor:y}=S(A),x=u(m[m.length-1]),n=u(m[Math.max(0,m.length-100)]),w=[x,n],d=(t-g.top-g.bottom)/3;return e.createElement(de,{height:t,ratio:r,width:s,margin:this.margin,data:m,displayXAccessor:y,seriesName:"Data",xScale:F,xAccessor:u,xExtents:w},e.createElement(O,{id:1,height:d,origin:(i,l)=>[0,l-3*d],yExtents:[0,100]},e.createElement(C,{axisAt:"bottom",orient:"bottom",showGridLines:!0,showTickLabel:!1,outerTickSize:0}),e.createElement(V,{axisAt:"right",orient:"right",tickValues:[20,50,80]}),e.createElement(P,{rectWidth:this.margin.right,displayFormat:this.displayFormat}),e.createElement(f,{yAccessor:i=>i.slowSTO}),e.createElement(k,{origin:[8,16],yAccessor:i=>i.slowSTO,options:a.options(),appearance:{stroke:f.defaultProps.strokeStyle},label:"Slow STO"})),e.createElement(O,{id:2,height:d,origin:(i,l)=>[0,l-2*d],yExtents:[0,100]},e.createElement(C,{axisAt:"bottom",orient:"bottom",showGridLines:!0,showTickLabel:!1,outerTickSize:0}),e.createElement(V,{axisAt:"right",orient:"right",tickValues:[20,50,80]}),e.createElement(P,{rectWidth:this.margin.right,displayFormat:this.displayFormat}),e.createElement(f,{yAccessor:i=>i.fastSTO}),e.createElement(k,{origin:[8,16],yAccessor:i=>i.slowSTO,options:a.options(),appearance:{stroke:f.defaultProps.strokeStyle},label:"Fast STO"})),e.createElement(O,{id:3,height:d,origin:(i,l)=>[0,l-d],yExtents:[0,100]},e.createElement(C,{axisAt:"bottom",orient:"bottom",showGridLines:!0}),e.createElement(V,{axisAt:"right",orient:"right",tickValues:[20,50,80]}),e.createElement(Se,{displayFormat:this.timeDisplayFormat}),e.createElement(P,{rectWidth:this.margin.right,displayFormat:this.displayFormat}),e.createElement(f,{yAccessor:i=>i.fullSTO}),e.createElement(k,{origin:[8,16],yAccessor:i=>i.slowSTO,options:a.options(),appearance:{stroke:f.defaultProps.strokeStyle},label:"Full STO"})),e.createElement(ye,null))}}const Ee=ie()(ae()(ce()(B)));try{B.displayName="StoIndicator",B.__docgenInfo={description:"",displayName:"StoIndicator",props:{}}}catch{}try{componentDidMount.displayName="componentDidMount",componentDidMount.__docgenInfo={description:"Called immediately after a component is mounted. Setting state here will trigger re-rendering.",displayName:"componentDidMount",props:{}}}catch{}const qe={title:"Visualization/Indicator/Stochastic Oscillator",component:T},_=()=>e.createElement(Ee,null);var Y,j,R;_.parameters={..._.parameters,docs:{...(Y=_.parameters)==null?void 0:Y.docs,source:{originalSource:"() => <StoIndicator />",...(R=(j=_.parameters)==null?void 0:j.docs)==null?void 0:R.source}}};const Xe=["basic"];export{Xe as __namedExportsOrder,_ as basic,qe as default};
