import{r as d}from"./index-CTzypqlY.js";import{c as Q,p as k,G as S,b as F,w as T,m as A,n as q,o as X,X as j,Y as z}from"./withSize-Bqu-aQP_.js";import{w as I}from"./withOHLCData-BEr55ucm.js";import{b as G,r as P}from"./baseIndicator-qdS_KWkb.js";import{P as E}from"./defaultOptionsForComputation-CN7nWbKN.js";import{d as L}from"./discontinuousTimeScaleProvider-DjLVsG-0.js";import"./jsx-runtime-D_zvdyIk.js";import"./index-kspPnZk0.js";function M(u,e,o){const t={open:u.open,fromDate:e(u),toDate:e(u),startOfYear:u.startOfYear,startOfQuarter:u.startOfQuarter,startOfMonth:u.startOfMonth,startOfWeek:u.startOfWeek};return o(t,e(u)),t}function R(u,e,o){return u.forEach(function(t){t.startOfYear=!1,t.startOfQuarter=!1,t.startOfMonth=!1,t.startOfWeek=!1,t.boxes.forEach(function(n){t.open===void 0&&(t.open=n.open),t.close=n.close,t.high=Math.max(t.open,t.close),t.low=Math.min(t.open,t.close),t.fromDate===void 0&&(t.fromDate=n.fromDate),t.date===void 0&&(t.date=n.date),t.toDate=n.toDate,n.startOfYear&&(t.startOfYear=t.startOfYear||n.startOfYear,t.startOfQuarter=n.startOfQuarter,t.startOfMonth=n.startOfMonth,t.startOfWeek=n.startOfWeek,o(t,e(n))),t.startOfQuarter!==!0&&n.startOfQuarter&&(t.startOfQuarter=n.startOfQuarter,t.startOfMonth=n.startOfMonth,t.startOfWeek=n.startOfWeek,o(t,e(n))),t.startOfMonth!==!0&&n.startOfMonth&&(t.startOfMonth=n.startOfMonth,t.startOfWeek=n.startOfWeek,o(t,e(n))),t.startOfWeek!==!0&&n.startOfWeek&&(t.startOfWeek=n.startOfWeek,o(t,e(n)))})}),u}function $(){let u=E,e=n=>n.date,o=(n,h)=>{n.date=h};const t=n=>{const{reversal:h,boxSize:l,sourcePath:f}=u,c=f==="high/low"?a=>({high:a.high,low:a.low}):a=>({high:a.close,low:a.close}),i=[];let s={boxes:[],open:n[0].open},r=M(n[0],e,o);return i.push(s),n.forEach(function(a){if(s.volume=(s.volume||0)+a.volume,r.startOfYear||(r.startOfYear=a.startOfYear,r.startOfYear&&o(r,e(a))),!r.startOfYear&&!r.startOfQuarter&&(r.startOfQuarter=a.startOfQuarter,r.startOfQuarter&&!r.startOfYear&&o(r,e(a))),!r.startOfQuarter&&!r.startOfMonth&&(r.startOfMonth=a.startOfMonth,r.startOfMonth&&!r.startOfQuarter&&o(r,e(a))),!r.startOfMonth&&!r.startOfWeek&&(r.startOfWeek=a.startOfWeek,r.startOfWeek&&!r.startOfMonth&&o(r,e(a))),i.length===1&&s.boxes.length===0){const m=Math.max(c(a).high-s.open,0),O=Math.abs(Math.min(s.open-c(a).low,0));if(s.direction=m>O?1:-1,l*h<m||l*h<O){r.toDate=e(a),r.open=s.open;const g=s.direction>0?Math.floor(m/l):Math.floor(O/l);for(let w=0;w<g;w++){r.close=r.open+s.direction*l;const W=r.close;s.boxes.push(r),r=M(r,e,o),r.open=W}r.fromDate=e(a),r.date=e(a)}}else{const m=Math.max(c(a).high-r.open,0),O=Math.abs(Math.min(c(a).low-r.open,0));if(s.direction>0&&m>l||s.direction<0&&O>l){r.close=r.open+s.direction*l,r.toDate=e(a);const g=r.close;s.boxes.push(r),r=M(a,e,o),r.open=g,r.fromDate=e(a),o(r,e(a))}else if(s.direction>0&&O>l*h||s.direction<0&&m>l*h){r.open=r.open+-1*s.direction*l,r.toDate=e(a),o(r,e(a)),s={boxes:[],volume:0,direction:-1*s.direction};const g=s.direction>0?Math.floor(m/l):Math.floor(O/l);for(let w=0;w<g;w++){r.close=r.open+s.direction*l;const W=r.close;s.boxes.push(r),r=M(a,e,o),r.open=W}i.push(s)}}}),R(i,e,o),i};return t.options=n=>n===void 0?u:(u=Object.assign(Object.assign({},E),n),t),t.dateMutator=n=>n===void 0?o:(o=n,t),t.dateAccessor=n=>n===void 0?e:(e=n,t),t}const U="PointAndFigure";function J(){const u=G().type(U),e=$(),o=e;return P(o,u,"id","stroke","fill","echo","type"),P(o,e,"dateAccessor","dateMutator","options"),o}let H=class extends d.Component{constructor(){super(...arguments),this.drawOnCanvas=(e,o)=>{const{xAccessor:t,xScale:n,chartConfig:{yScale:h},plotData:l}=o,f=this.getColumns(n,t,h,l);this.drawOnCanvasPrivate(e,this.props,f)},this.getColumns=(e,o,t,n)=>{const l=(e(o(n[n.length-1]))-e(o(n[0])))/(n.length-1);let f,p=0;for(;Q(f)&&k(n[p].close);){f=n[p].boxes[0];p++}const c=Math.abs(t(f.open)-t(f.close));return n.filter(s=>k(s.close)).map(s=>{const r=s.boxes.map(m=>({columnWidth:l,boxHeight:c,open:t(m.open),close:t(m.close)})),a=e(o(s))-l/2;return{boxes:r,direction:s.direction,offset:[a,0]}})},this.drawOnCanvasPrivate=(e,o,t)=>{const{stroke:n,fill:h,strokeWidth:l}=o;e.lineWidth=l,t.forEach(f=>{const[p,c]=f.offset;f.boxes.forEach(i=>{if(f.direction>0)e.fillStyle=h.up,e.strokeStyle=n.up,e.beginPath(),e.moveTo(p,c+i.open),e.lineTo(p+i.columnWidth,c+i.close),e.moveTo(p,c+i.close),e.lineTo(p+i.columnWidth,c+i.open),e.stroke();else{e.fillStyle=h.down,e.strokeStyle=n.down,e.beginPath();const[s,r]=[p+i.columnWidth/2,c+i.open+i.boxHeight/2],[a,m]=[i.columnWidth/2,i.boxHeight/2];e.ellipse(s,r,a,m,0,0,2*Math.PI),e.stroke()}})}),e.stroke()}}render(){const{clip:e}=this.props;return d.createElement(S,{clip:e,canvasDraw:this.drawOnCanvas,canvasToDraw:F,drawOn:["pan"]})}};H.defaultProps={className:"react-financial-charts-point-and-figure",strokeWidth:1,stroke:{up:"#6BA583",down:"#FF0000"},fill:{up:"none",down:"none"},clip:!0};const C=class C extends d.Component{constructor(){super(...arguments),this.drawOnCanvas=(e,o)=>{const{xAccessor:t,xScale:n,chartConfig:{yScale:h},plotData:l}=o,f=this.getColumns(n,t,h,l);this.drawOnCanvasPrivate(e,this.props,f)},this.getColumns=(e,o,t,n)=>{const l=(e(o(n[n.length-1]))-e(o(n[0])))/(n.length-1);let f,p=0;for(;Q(f)&&k(n[p].close);){f=n[p].boxes[0];p++}const c=Math.abs(t(f.open)-t(f.close));return n.filter(s=>k(s.close)).map(s=>{const r=s.boxes.map(m=>({columnWidth:l,boxHeight:c,open:t(m.open),close:t(m.close)})),a=e(o(s))-l/2;return{boxes:r,direction:s.direction,offset:[a,0]}})},this.drawOnCanvasPrivate=(e,o,t)=>{const{stroke:n,fill:h,strokeWidth:l}=o;e.lineWidth=l,t.forEach(f=>{const[p,c]=f.offset;f.boxes.forEach(i=>{if(f.direction>0)e.fillStyle=h.up,e.strokeStyle=n.up,e.beginPath(),e.moveTo(p,c+i.open),e.lineTo(p+i.columnWidth,c+i.close),e.moveTo(p,c+i.close),e.lineTo(p+i.columnWidth,c+i.open),e.stroke();else{e.fillStyle=h.down,e.strokeStyle=n.down,e.beginPath();const[s,r]=[p+i.columnWidth/2,c+i.open+i.boxHeight/2],[a,m]=[i.columnWidth/2,i.boxHeight/2];e.ellipse(s,r,a,m,0,0,2*Math.PI),e.stroke()}})}),e.stroke()}}render(){const{clip:e}=this.props;return d.createElement(S,{clip:e,canvasDraw:this.drawOnCanvas,canvasToDraw:F,drawOn:["pan"]})}};C.defaultProps={className:"react-financial-charts-point-and-figure",strokeWidth:1,stroke:{up:"#6BA583",down:"#FF0000"},fill:{up:"none",down:"none"},clip:!0};let y=C;try{y.displayName="PointAndFigureSeries",y.__docgenInfo={description:"",displayName:"PointAndFigureSeries",props:{className:{defaultValue:{value:"react-financial-charts-point-and-figure"},description:"",name:"className",required:!1,type:{name:"string | undefined"}},clip:{defaultValue:{value:"true"},description:"",name:"clip",required:!1,type:{name:"boolean | undefined"}},fill:{defaultValue:{value:`{
            up: "none",
            down: "none",
        }`},description:"",name:"fill",required:!1,type:{name:"{ up: string; down: string; } | undefined"}},stroke:{defaultValue:{value:`{
            up: "#6BA583",
            down: "#FF0000",
        }`},description:"",name:"stroke",required:!1,type:{name:"{ up: string; down: string; } | undefined"}},strokeWidth:{defaultValue:{value:"1"},description:"",name:"strokeWidth",required:!1,type:{name:"number | undefined"}}}}}catch{}class V extends d.Component{constructor(){super(...arguments),this.margin={left:0,right:40,top:0,bottom:24},this.xScaleProvider=L().inputDateAccessor(e=>e.date),this.yExtents=e=>[e.high,e.low]}render(){const{data:e,height:o,ratio:t,width:n}=this.props,l=J()(e),{data:f,xScale:p,xAccessor:c,displayXAccessor:i}=this.xScaleProvider(l),s=c(f[f.length-1]),a=[c(f[Math.max(0,f.length-100)]),s];return d.createElement(q,{height:o,ratio:t,width:n,margin:this.margin,data:f,displayXAccessor:i,seriesName:"Data",xScale:p,xAccessor:c,xExtents:a},d.createElement(X,{id:1,yExtents:this.yExtents},d.createElement(H,null),d.createElement(j,null),d.createElement(z,null)))}}const _=I()(T()(A()(V))),b=I("MINUTES")(T()(A()(V)));try{_.displayName="Daily",_.__docgenInfo={description:"",displayName:"Daily",props:{}}}catch{}try{componentDidMount.displayName="componentDidMount",componentDidMount.__docgenInfo={description:"Called immediately after a component is mounted. Setting state here will trigger re-rendering.",displayName:"componentDidMount",props:{}}}catch{}try{b.displayName="Intraday",b.__docgenInfo={description:"",displayName:"Intraday",props:{}}}catch{}const se={component:y,title:"Visualization/Series/Point & Figure"},v=()=>d.createElement(_,null);var D,Y,N;v.parameters={...v.parameters,docs:{...(D=v.parameters)==null?void 0:D.docs,source:{originalSource:"() => <Daily />",...(N=(Y=v.parameters)==null?void 0:Y.docs)==null?void 0:N.source}}};const ae=["daily"];export{ae as __namedExportsOrder,v as daily,se as default};
