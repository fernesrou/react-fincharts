import{r as d}from"./index-CTzypqlY.js";import{p as z,G as V,b as q,w as H,m as L,n as J,o as K,X as Z,Y as ee}from"./withSize-Bqu-aQP_.js";import{w as j}from"./withOHLCData-BEr55ucm.js";import{b as te,r as T}from"./baseIndicator-qdS_KWkb.js";import{a as oe}from"./atr-C5J7OhYf.js";import{R as B}from"./defaultOptionsForComputation-CN7nWbKN.js";import{m as re}from"./merge-WqXt2Bz7.js";import{f as ne}from"./functor-Bsi8uwFK.js";import{d as se}from"./discontinuousTimeScaleProvider-DjLVsG-0.js";import"./jsx-runtime-D_zvdyIk.js";import"./index-kspPnZk0.js";import"./slidingWindow-Zblwndst.js";import"./path-uFnBsLuY.js";function ae(){let u=B,t=r=>r.date,a=(r,s)=>{r.date=s};const l=r=>{const{reversalType:s,fixedBrickSize:c,sourcePath:f,windowSize:p}=u,n=f==="high/low"?o=>({high:o.high,low:o.low}):o=>({high:o.close,low:o.close});let i;if(s==="ATR"){const o=oe().options({windowSize:p});re().algorithm(o).merge((O,M)=>{O["atr"+p]=M})(r),i=O=>O["atr"+p]}else i=ne(c);const g=[];let m=0,y=r[m].open,w=r[m].open,e={},E=0;return r.forEach(function(o,v){e.from===void 0&&(e.high=o.high,e.low=o.low,e.startOfYear=o.startOfYear,e.startOfQuarter=o.startOfQuarter,e.startOfMonth=o.startOfMonth,e.startOfWeek=o.startOfWeek,e.from=v,e.fromDate=t(o),a(e,t(o))),e.volume=(e.volume||0)+o.volume;const O=y-n(o).high,M=y-n(o).low,P=w-n(o).high,x=w-n(o).low,U=Math.min(Math.abs(O),Math.abs(M),Math.abs(P),Math.abs(x));if(e.high=Math.max(e.high,o.high),e.low=Math.min(e.low,o.low),e.startOfYear||(e.startOfYear=o.startOfYear,e.startOfYear&&a(e,t(o))),e.startOfQuarter||(e.startOfQuarter=o.startOfQuarter,e.startOfQuarter&&!e.startOfYear&&a(e,t(o))),e.startOfMonth||(e.startOfMonth=o.startOfMonth,e.startOfMonth&&!e.startOfQuarter&&a(e,t(o))),e.startOfWeek||(e.startOfWeek=o.startOfWeek,e.startOfWeek&&!e.startOfMonth&&a(e,t(o))),i(o)){const D=Math.floor(U/i(o));if(e.open=Math.abs(O)<Math.abs(P)||Math.abs(M)<Math.abs(x)?y:w,D>=1){let _=0;for(_=0;_<D;_++)e.close=e.open<n(o).high?e.open+i(o):e.open-i(o),E=e.close>e.open?1:-1,e.direction=E,e.to=v,e.toDate=t(o),e.fullyFormed=!0,g.push(e),y=e.close,w=e.open,e={high:e.high,low:e.low,open:e.close,startOfYear:!1,startOfMonth:!1,startOfQuarter:!1,startOfWeek:!1},e.from=v,e.fromDate=t(o),a(e,t(o)),e.volume=(e.volume||0)+o.volume;m=m+_-1,e={}}else v===r.length-1&&(e.close=E>0?n(o).high:n(o).low,e.to=v,e.toDate=t(o),a(e,t(o)),e.fullyFormed=!1,g.push(e))}}),g};return l.options=r=>r===void 0?u:(u=Object.assign(Object.assign({},B),r),l),l.dateMutator=r=>r===void 0?a:(a=r,l),l.dateAccessor=r=>r===void 0?t:(t=r,l),l}const ie="Renko";function le(){const u=te().type(ie),t=ae(),a=t;return T(a,u,"id","stroke","fill","echo","type"),T(a,t,"options","dateAccessor","dateMutator"),a}let G=class X extends d.Component{constructor(){super(...arguments),this.drawOnCanvas=(t,a)=>{const{xAccessor:l,xScale:r,chartConfig:{yScale:s},plotData:c}=a;this.getRenko(c,r,l,s).forEach(p=>{const{fillStyle:h,strokeStyle:n}=p;t.beginPath(),n!==void 0&&(t.strokeStyle=n),h!==void 0&&(t.fillStyle=h),t.rect(p.x,p.y,p.width,p.height),t.closePath(),t.fill()})},this.getRenko=(t,a,l,r)=>{const{fill:s,stroke:c,yAccessor:f=X.defaultProps.yAccessor}=this.props,h=(a(l(t[t.length-1]))-a(l(t[0])))/(t.length-1);return t.filter(n=>z(f(n).close)).map(n=>{const i=f(n),g=a(l(n))-.5*h,m=r(Math.max(i.open,i.close)),y=Math.abs(r(i.open)-r(i.close)),w=n.fullyFormed?i.open<=i.close?s==null?void 0:s.up:s==null?void 0:s.down:s==null?void 0:s.partial,e=n.fullyFormed?i.open<=i.close?c==null?void 0:c.up:c==null?void 0:c.down:void 0;return{fillStyle:w,height:y,strokeStyle:e,width:h,x:g,y:m}})}}render(){const{clip:t}=this.props;return d.createElement(V,{clip:t,canvasDraw:this.drawOnCanvas,canvasToDraw:q,drawOn:["pan"]})}};G.defaultProps={clip:!0,fill:{up:"#26a69a",down:"#ef5350",partial:"#4682B4"},stroke:{up:"none",down:"none"},yAccessor:u=>({open:u.open,high:u.high,low:u.low,close:u.close})};const C=class C extends d.Component{constructor(){super(...arguments),this.drawOnCanvas=(t,a)=>{const{xAccessor:l,xScale:r,chartConfig:{yScale:s},plotData:c}=a;this.getRenko(c,r,l,s).forEach(p=>{const{fillStyle:h,strokeStyle:n}=p;t.beginPath(),n!==void 0&&(t.strokeStyle=n),h!==void 0&&(t.fillStyle=h),t.rect(p.x,p.y,p.width,p.height),t.closePath(),t.fill()})},this.getRenko=(t,a,l,r)=>{const{fill:s,stroke:c,yAccessor:f=C.defaultProps.yAccessor}=this.props,h=(a(l(t[t.length-1]))-a(l(t[0])))/(t.length-1);return t.filter(n=>z(f(n).close)).map(n=>{const i=f(n),g=a(l(n))-.5*h,m=r(Math.max(i.open,i.close)),y=Math.abs(r(i.open)-r(i.close)),w=n.fullyFormed?i.open<=i.close?s==null?void 0:s.up:s==null?void 0:s.down:s==null?void 0:s.partial,e=n.fullyFormed?i.open<=i.close?c==null?void 0:c.up:c==null?void 0:c.down:void 0;return{fillStyle:w,height:y,strokeStyle:e,width:h,x:g,y:m}})}}render(){const{clip:t}=this.props;return d.createElement(V,{clip:t,canvasDraw:this.drawOnCanvas,canvasToDraw:q,drawOn:["pan"]})}};C.defaultProps={clip:!0,fill:{up:"#26a69a",down:"#ef5350",partial:"#4682B4"},stroke:{up:"none",down:"none"},yAccessor:t=>({open:t.open,high:t.high,low:t.low,close:t.close})};let k=C;try{k.displayName="RenkoSeries",k.__docgenInfo={description:"",displayName:"RenkoSeries",props:{clip:{defaultValue:{value:"true"},description:"",name:"clip",required:!1,type:{name:"boolean | undefined"}},fill:{defaultValue:{value:`{
            up: "#26a69a",
            down: "#ef5350",
            partial: "#4682B4",
        }`},description:"",name:"fill",required:!1,type:{name:"{ up: string; down: string; partial: string; } | undefined"}},stroke:{defaultValue:{value:`{
            up: "none",
            down: "none",
        }`},description:"",name:"stroke",required:!1,type:{name:"{ up: string; down: string; } | undefined"}},yAccessor:{defaultValue:{value:"(d: any) => ({ open: d.open, high: d.high, low: d.low, close: d.close })"},description:"",name:"yAccessor",required:!1,type:{name:"((data: any) => any) | undefined"}}}}}catch{}class $ extends d.Component{constructor(){super(...arguments),this.margin={left:0,right:40,top:0,bottom:24},this.xScaleProvider=se().inputDateAccessor(t=>t.date),this.yExtents=t=>[t.high,t.low]}render(){const{data:t,height:a,ratio:l,width:r}=this.props,c=le()(t),{data:f,xScale:p,xAccessor:h,displayXAccessor:n}=this.xScaleProvider(c),i=h(f[f.length-1]),m=[h(f[Math.max(0,f.length-100)]),i];return d.createElement(J,{height:a,ratio:l,width:r,margin:this.margin,data:f,displayXAccessor:n,seriesName:"Data",xScale:p,xAccessor:h,xExtents:m},d.createElement(K,{id:1,yExtents:this.yExtents},d.createElement(G,null),d.createElement(Z,null),d.createElement(ee,null)))}}const A=j()(H()(L()($))),R=j("MINUTES")(H()(L()($)));try{A.displayName="Daily",A.__docgenInfo={description:"",displayName:"Daily",props:{}}}catch{}try{componentDidMount.displayName="componentDidMount",componentDidMount.__docgenInfo={description:"Called immediately after a component is mounted. Setting state here will trigger re-rendering.",displayName:"componentDidMount",props:{}}}catch{}try{R.displayName="Intraday",R.__docgenInfo={description:"",displayName:"Intraday",props:{}}}catch{}const _e={component:k,title:"Visualization/Series/Renko"},S=()=>d.createElement(A,null),b=()=>d.createElement(R,null);var I,Y,N;S.parameters={...S.parameters,docs:{...(I=S.parameters)==null?void 0:I.docs,source:{originalSource:"() => <Daily />",...(N=(Y=S.parameters)==null?void 0:Y.docs)==null?void 0:N.source}}};var W,Q,F;b.parameters={...b.parameters,docs:{...(W=b.parameters)==null?void 0:W.docs,source:{originalSource:"() => <Intraday />",...(F=(Q=b.parameters)==null?void 0:Q.docs)==null?void 0:F.source}}};const Se=["daily","intraday"];export{Se as __namedExportsOrder,S as daily,_e as default,b as intraday};
