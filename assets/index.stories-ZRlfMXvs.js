import{r as t}from"./index-CTzypqlY.js";import{w as L}from"./withOHLCData-BEr55ucm.js";import{w as I,m as M,a as h,t as w,n as v,o as T,X as G,Y as N}from"./withSize-Bqu-aQP_.js";import{b as O,r as y}from"./baseIndicator-qdS_KWkb.js";import{C as _}from"./defaultOptionsForComputation-CN7nWbKN.js";import{p as j}from"./path-uFnBsLuY.js";import{m as K}from"./merge-WqXt2Bz7.js";import{d as X}from"./discontinuousTimeScaleProvider-DjLVsG-0.js";import{M as Y}from"./MouseCoordinateX-BVdS_xjN.js";import{M as H}from"./MouseCoordinateY-B1fOyXbI.js";import{L as E}from"./LineSeries-5eeGgUw4.js";import{E as C}from"./EdgeIndicator-17zBkVdX.js";import{S as A}from"./SingleValueTooltip-CQ4GxCuA.js";import{C as $}from"./CrossHairCursor-C6hnYaC-.js";import"./jsx-runtime-D_zvdyIk.js";import"./index-kspPnZk0.js";import"./array-2GBN5xbU.js";import"./ToolTipTSpanLabel-D8pipyNG.js";function z(){let s=_;const r=o=>{const{basePath:c,mainKeys:a,compareKeys:m}=s,l=j(c),u=o[0],n=l(u),p={};return o.map(i=>{const d={};return a.forEach(e=>{typeof i[e]=="object"?(d[e]={},Object.keys(i[e]).forEach(f=>{d[e][f]=(i[e][f]-n)/n})):d[e]=(i[e]-n)/n}),m.forEach(e=>{i[e]!==void 0&&p[e]===void 0&&(p[e]=i[e]),i[e]!==void 0&&p[e]!==void 0&&(d[e]=(i[e]-p[e])/p[e])}),d})};return r.options=o=>o===void 0?s:(s=Object.assign(Object.assign({},_),o),r),r}const b="Compare";function R(){const s=O().type(b).accessor(a=>a.compare),r=z(),o=K().algorithm(r).merge((a,m)=>{a.compare=m}),c=(a,m={merge:!0})=>{if(m.merge){if(!s.accessor())throw new Error(`Set an accessor to ${b} before calculating`);return o(a)}return r(a)};return y(c,s,"id","accessor","stroke","fill","echo","type"),y(c,r,"options"),y(c,o,"merge"),c}class S extends t.Component{constructor(){super(...arguments),this.percentFormat=h(".0%"),this.timeDisplayFormat=w("%d %b"),this.margin={left:0,right:40,top:8,bottom:24},this.xScaleProvider=X().inputDateAccessor(r=>r.date),this.yExtents=r=>r.compare}render(){const{data:r,height:o,ratio:c,width:a}=this.props,m=R().options({basePath:"close",mainKeys:["open","high","low","close"],compareKeys:["AAPLClose","SP500Close","GEClose"]}).accessor(e=>e.compare).merge((e,f)=>{e.compare=f}),{data:l,xScale:u,xAccessor:n,displayXAccessor:p}=this.xScaleProvider(r),F=n(l[l.length-1]),d=[n(l[Math.max(0,l.length-100)]),F];return t.createElement(v,{height:o,ratio:c,width:a,margin:this.margin,data:l,displayXAccessor:p,postCalculator:m,seriesName:"Data",xScale:u,xAccessor:n,xExtents:d},t.createElement(T,{id:1,yExtents:this.yExtents},t.createElement(G,null),t.createElement(N,{tickFormat:this.percentFormat}),t.createElement(Y,{displayFormat:this.timeDisplayFormat}),t.createElement(H,{rectWidth:this.margin.right,displayFormat:this.percentFormat}),t.createElement(E,{yAccessor:e=>e.compare.AAPLClose,strokeStyle:"#ff7f0e"}),t.createElement(E,{yAccessor:e=>e.compare.SP500Close,strokeStyle:"#2ca02c"}),t.createElement(E,{yAccessor:e=>e.compare.GEClose,strokeStyle:"#2196f3"}),t.createElement(C,{itemType:"last",orient:"right",edgeAt:"right",yAccessor:e=>e.compare.AAPLClose,fill:"#ff7f0e",lineStroke:"#ff7f0e",displayFormat:this.percentFormat}),t.createElement(C,{itemType:"last",orient:"right",edgeAt:"right",yAccessor:e=>e.compare.SP500Close,fill:"#2ca02c",lineStroke:"#2ca02c",displayFormat:this.percentFormat}),t.createElement(C,{itemType:"last",orient:"right",edgeAt:"right",fill:"#2196f3",lineStroke:"#2196f3",yAccessor:e=>e.compare.GEClose,displayFormat:this.percentFormat}),t.createElement(A,{yAccessor:e=>e.AAPLClose,yLabel:"AAPL",yDisplayFormat:h(".2f"),valueFill:"#ff7f0e",origin:[8,16]}),t.createElement(A,{yAccessor:e=>e.SP500Close,yLabel:"S&P 500",yDisplayFormat:h(".2f"),valueFill:"#2ca02c",origin:[8,32]}),t.createElement(A,{yAccessor:e=>e.GEClose,yLabel:"GE",yDisplayFormat:h(".2f"),origin:[8,48]})),t.createElement($,null))}}const V=L("comparison")(I()(M()(S)));try{S.displayName="CompareIndicator",S.__docgenInfo={description:"",displayName:"CompareIndicator",props:{}}}catch{}try{componentDidMount.displayName="componentDidMount",componentDidMount.__docgenInfo={description:"Called immediately after a component is mounted. Setting state here will trigger re-rendering.",displayName:"componentDidMount",props:{}}}catch{}const le={title:"Visualization/Indicator/Compare"},g=()=>t.createElement(V,null);var x,D,P;g.parameters={...g.parameters,docs:{...(x=g.parameters)==null?void 0:x.docs,source:{originalSource:"() => <CompareIndicator />",...(P=(D=g.parameters)==null?void 0:D.docs)==null?void 0:P.source}}};const pe=["basic"];export{pe as __namedExportsOrder,g as basic,le as default};
